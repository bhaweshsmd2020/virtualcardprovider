import{D as z,j as d,T as U,Y as $,i as B,k as E,x as K,o as u,c as p,a as m,u as r,b as e,l as _,t as v,n as h,w as N,F as y,r as I,h as O,f as P,Z as M,g as f,v as j,J as L}from"./app-55c25e51.js";import{s as J}from"./sharedComposable-713147fd.js";import{I as W}from"./InputFieldError-c6069bf2.js";import{S as Y}from"./SpinnerBtn-5f5f7277.js";import{_ as Z}from"./AuthLayout-99377f0c.js";import"./toastComposable-bc1f97e9.js";import"./ToastrContainer-869d906f.js";import"./SeoMeta-0212affe.js";/* empty css                                                   */const q={class:"register-wrapper d-flex justify-content-center align-items-center"},G={class:"register-container d-flex position-relative"},H={class:"top-left-logo"},Q={href:"/"},R={alt:"logo"},X={class:"register-image"},ee={alt:""},te={class:"register-form"},oe={class:"d-flex justify-content-end mb-30"},se={method:"POST",action:"#"},ae={class:"text-2xl font-semibold"},re={class:"my-6 text-sm"},ne={class:"mx-auto flex max-w-72 items-center"},le=["onUpdate:modelValue","onKeyup","readonly"],ie=e("span",{class:"scale-[2] px-4 opacity-60"},"-",-1),ce=["onUpdate:modelValue","onKeyup","readonly"],ue=e("p",{class:"mt-4 text-xs"},[O("Do you want to recover TWO-Factor Authentication? or "),e("a",{href:"mailto:help@virtualcardprovider.com"},"Need help?")],-1),pe=P({layout:Z}),Fe=Object.assign(pe,{__name:"TwoFactorAuthentication",props:{authPages:Object},setup(A){var k;const{authUser:de,logout:C,uiAvatar:me}=J(),o=z(["","","","","",""]),i=d(null),a=d(0),n=d(3),l=U({one_time_password:""}),S=((k=A.authPages)==null?void 0:k.login)??{},g=d(!1);$(()=>l.errors.one_time_password,()=>{l.errors.one_time_password&&(g.value=!0,setTimeout(()=>{g.value=!1},1e3))});const b=s=>{L(()=>{o[s].length&&s<o.length-1?(a.value=s+1,i.value[a.value].focus()):!o[s].length&&s>0&&(a.value=s-1,i.value[a.value].focus())}),s===o.length-1&&o[s].length&&w()};B(()=>{i.value[a.value].focus()});const w=()=>{l.one_time_password=o.join(""),l.clearErrors(),l.post("/user/google2fa/authenticate")};return(s,T)=>{var V;const x=E("Icon"),F=K("lazy");return u(),p(y,null,[m(r(M),{title:"Two Factor Authentication"}),e("div",q,[e("div",G,[e("div",H,[e("a",Q,[_(e("img",R,null,512),[[F,(V=s.$page.props.primaryData)==null?void 0:V.deep_logo]])])]),e("div",X,[_(e("img",ee,null,512),[[F,r(S).image2]])]),e("div",te,[e("div",oe,[e("form",se,[e("button",{type:"button",onClick:T[0]||(T[0]=D=>r(C)()),class:"signin-button"},[m(x,{icon:"fe:logout",style:{"margin-top":"3px"}}),e("span",null,v(r(f)("Logout")),1)])])]),e("div",{class:h(["card mt-8 p-12 shadow-lg",{shake:g.value}])},[e("h4",ae,v(r(f)("Verify that it's you!")),1),e("p",re,v(r(f)("Enter six-digit code from your authentication app")),1),e("form",{onSubmit:N(w,["prevent"]),class:"account-login"},[e("div",ne,[(u(!0),p(y,null,I(o.slice(0,3),(D,t)=>_((u(),p("input",{key:t,type:"tel",class:h(["w-full border py-4 focus:border-primary-500 focus:ring-1 focus:ring-primary-500 dark:border-gray-700 dark:bg-secondary-900",{"rounded-l-md":t==0,"z-50":t==a.value,"rounded-r-md":t==2}]),"onUpdate:modelValue":c=>o[t]=c,onKeyup:c=>b(t),ref_for:!0,ref_key:"inputs",ref:i,maxlength:"1",pattern:"[0-9]",readonly:t!==a.value},null,42,le)),[[j,o[t]]])),128)),ie,(u(!0),p(y,null,I(o.slice(n.value),(D,t)=>_((u(),p("input",{key:n.value+t,type:"tel",class:h(["w-full border py-4 focus:border-primary-500 focus:ring-1 focus:ring-primary-500 dark:border-gray-700 dark:bg-secondary-900",{"rounded-l-md":t==0,"z-50":n.value+t==a.value,"rounded-r-md":t==2}]),"onUpdate:modelValue":c=>o[n.value+t]=c,onKeyup:c=>b(n.value+t),ref_for:!0,ref_key:"inputs",ref:i,maxlength:"1",pattern:"[0-9]",readonly:n.value+t!==a.value},null,42,ce)),[[j,o[n.value+t]]])),128))]),m(Y,{type:"submit",processing:r(l).processing,class:"btn btn-primary mt-6 w-full py-3 font-semibold","btn-text":r(f)("Continue")},null,8,["processing","btn-text"]),m(W,{message:r(l).errors.one_time_password},null,8,["message"]),ue],32)],2)])])])],64)}}});export{Fe as default};
