import{j as c,z as u,o as n,d as F,p as N,u as x,b as t,l as y,v as k,t as o,c as i,r as j,P as E,e as b,w as U,F as f,h as V,O as D}from"./app-55c25e51.js";import"./toastComposable-bc1f97e9.js";import{s as H}from"./sharedComposable-713147fd.js";import{u as I,_ as $}from"./Modal-522ea419.js";import{S as d}from"./sweetalert2.esm.all-df3a4912.js";const G={class:"mx-auto mt-6 space-y-5 p-3"},Y={class:"text-sm font-semibold"},R={class:"my-4 grid grid-cols-4 gap-2"},J={class:"relative rounded border dark:border-gray-600"},K=t("i",{class:"bx bx-check absolute right-[-10px] top-[-10px] rounded-full bg-primary-600 p-0.5 text-white"},null,-1),Q={class:"text-lg font-bold"},W=["id"],X={key:0,class:"flex justify-center my-4"},Z=t("svg",{class:"animate-spin h-6 w-6 text-primary-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1),tt=[Z],et={class:"space-y-2 text-xs"},st={class:"flex items-center justify-between"},at={class:"dark:text-gray-200"},ot={class:"dark:text-gray-200"},nt={class:"flex items-center justify-between"},lt={class:"dark:text-gray-200"},it={class:"dark:text-gray-200"},rt={class:"label mt-4 font-semibold dark:text-gray-200"},ct={class:"mt-1 text-sm dark:text-gray-200"},ut={key:1,class:"mt-4"},dt={class:"label mb-1"},mt={class:"mt-2"},pt={class:"label mb-1"},ft={class:"mt-3"},_t={class:"label mb-1"},ht=["disabled"],kt={__name:"Deposit",props:["gateways","credit_card_id","virtual_card","prepaidcard","card_details"],setup(C){var S;const l=c({currency:"",type:"deposit",amount:100}),m=I(),r=C,{formatCurrency:_,authUser:A,calculatePercent:vt}=H(),T=c(((S=r.gateways[0])==null?void 0:S.id)||0),B=c(null),h=c(!1);c(!1);const w=c({image:null,comment:""}),P=u(()=>r.gateways.find(s=>s.id===T.value)),O=u(()=>r.prepaidcard.topup_limit),L=u(()=>r.prepaidcard.spending_limit),v=u(()=>r.virtual_card.increase_limit_fee),g=u(()=>{const s=l.value.amount*v.value/100;return l.value.amount+s}),q=u(()=>l.value.amount+r.card_details.spending_restrictions.amount),z=()=>{if(A.value.balance<g.value){let s=function(){d.fire({icon:"warning",title:"<h2 style='font-size: 20px;'>Insufficient Balance</h2>",confirmButtonText:"Okay",allowOutsideClick:!1,customClass:{popup:"custom-swal-popup"},didOpen:a=>{const e=document.createElement("button");e.innerHTML="&times;",e.classList.add("swal-close-btn"),e.onclick=()=>d.close(),a.appendChild(e)}})};m.close(),s();return}if(O.value<l.value.amount){let s=function(){d.fire({icon:"warning",title:`<h2 style='font-size: 20px;'>Maximum card topup is ${_(+O.value)}</h2>`,confirmButtonText:"Okay",allowOutsideClick:!1,customClass:{popup:"custom-swal-popup"},didOpen:a=>{const e=document.createElement("button");e.innerHTML="&times;",e.classList.add("swal-close-btn"),e.onclick=()=>d.close(),a.appendChild(e)}})};m.close(),s();return}if(L.value<q.value){let s=function(){d.fire({icon:"warning",title:`<h2 style='font-size: 20px;'>Total card spending limit is ${_(+L.value)}</h2>`,confirmButtonText:"Request to increase limit",allowOutsideClick:!1,customClass:{popup:"custom-swal-popup"},didOpen:a=>{const e=document.createElement("button");e.innerHTML="&times;",e.classList.add("swal-close-btn"),e.onclick=()=>d.close(),a.appendChild(e)}}).then(a=>{a.isConfirmed&&(window.location.href=route("user.supports.index"))})};m.close(),s();return}h.value=!0,D.post(route("user.credit-card.increase-limit"),{total:g.value,limit_fee:v.value,sub_total:+l.value.amount,credit_card_id:r.credit_card_id},{onFinish:()=>{h.value=!1,m.close()}})};return(s,a)=>(n(),F($,{"header-state":!0,"header-title":"Card Topup",state:x(m).states.deposit},{default:N(()=>[t("div",G,[y(t("input",{class:"input mb-2","onUpdate:modelValue":a[0]||(a[0]=e=>l.value.amount=e),name:"amount"},null,512),[[k,l.value.amount,void 0,{number:!0}]]),t("span",Y,o(s.trans("Sub Total:"))+" "+o(x(_)(l.value.amount)),1),t("div",R,[t("button",J,[K,t("span",Q,o(s.trans("Account")),1)])]),(n(!0),i(f,null,j(C.gateways,e=>{var M;return y((n(),i("div",{key:e.id,id:"gateway-form"+e.id},[h.value?(n(),i("div",X,tt)):b("",!0),t("form",{method:"post",onSubmit:U(z,["prevent"]),enctype:"multipart/form-data"},[t("div",et,[t("div",st,[t("span",at,o(s.trans("Topup Fee: ")),1),t("span",ot,[v.value>0?(n(),i(f,{key:0},[V(o(v.value)+" %",1)],64)):(n(),i(f,{key:1},[V(o(s.trans("Not charged")),1)],64))])]),t("div",nt,[t("span",lt,o(s.trans("Total: ")),1),t("span",it,o(x(_)(g.value)),1)])]),e.comment!=null?(n(),i(f,{key:0},[t("label",rt,o(s.trans("Payment Instruction: ")),1),t("p",ct,o(e.comment),1)],64)):b("",!0),e.phone_required==1?(n(),i("div",ut,[t("label",dt,o(s.trans("Your phone number")),1),y(t("input",{type:"tel",name:"phone",placeholder:"Your phone number",class:"input",required:"","onUpdate:modelValue":a[1]||(a[1]=p=>B.value=p)},null,512),[[k,B.value]])])):b("",!0),e.is_auto==0&&((M=P.value)==null?void 0:M.is_crypto)!=1?(n(),i(f,{key:2},[t("div",mt,[t("label",pt,o(s.trans("Submit your payment proof")),1),t("input",{onInput:a[2]||(a[2]=p=>{w.value.image=p.target.files[0]}),type:"file",name:"image",class:"input",required:"",accept:"image/*"},null,32)]),t("div",ft,[t("label",_t,o(s.trans("Comment")),1),y(t("textarea",{"onUpdate:modelValue":a[3]||(a[3]=p=>w.value.comment=p),class:"textarea",required:"",name:"comment",placeholder:"comment",maxlength:"500"},null,512),[[k,w.value.comment]])])],64)):b("",!0),t("button",{disabled:h.value,type:"submit",class:"btn btn-primary mt-4 w-full py-2 text-lg"},o(s.trans("Pay Now")),9,ht)],32)],8,W)),[[E,T.value===e.id]])}),128))])]),_:1},8,["state"]))}};export{kt as default};
