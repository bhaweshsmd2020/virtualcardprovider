import{T as A,z as k,x as q,o as c,c as l,a as F,b as s,t,p as V,u as a,d as H,e as b,F as g,h as d,l as C,v as L,r as M,f as O}from"./app-55c25e51.js";import{I as $}from"./InputFieldError-c6069bf2.js";import{s as G}from"./sharedComposable-713147fd.js";import{P as J}from"./PageHeader-8abf30c3.js";import{_ as K}from"./UserLayout-5a6919f2.js";import{s as D}from"./multiselect-5f58dd69.js";import"./toastComposable-bc1f97e9.js";import"./dropdown-8ee40221.js";import"./moment-a9aaa855.js";import"./Modal-522ea419.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./ToastrContainer-869d906f.js";const Q={class:"container flex-grow p-4 sm:p-6"},W={class:"mx-auto max-w-lg space-y-6"},X={class:"label text-xs"},Y={class:"multiselect-single-label"},Z={class:"mr-3 flex h-8 w-8 items-center justify-center rounded-md border bg-white"},ee={class:"h-5 w-5"},se={class:"flex items-center justify-between"},te={class:"text-sm"},ae={class:"uppercase"},ne={class:"flex w-40 translate-x-[9rem] flex-col items-end"},ce={class:"text-sm font-semibold uppercase leading-4"},re={key:0,class:"text-xs"},le={key:1,class:"text-xs"},oe={class:"mr-3 flex h-8 w-8 items-center justify-center rounded-md border bg-white"},ie={class:"h-5 w-5"},de={class:"flex items-center justify-between"},ue={class:"text-sm"},_e={class:"uppercase"},me={class:"flex w-40 translate-x-[10.8rem] flex-col items-end"},ye={class:"text-sm font-semibold uppercase"},he={key:0,class:"text-xs"},pe={key:1,class:"text-xs"},fe={class:"label text-xs"},xe={class:"multiselect-single-label"},be={class:"mr-3 flex h-8 w-8 items-center justify-center rounded-md border bg-white"},ge={class:"h-5 w-5"},ve={class:"flex items-center justify-between"},we={class:"text-sm"},ke={class:"uppercase"},Ce={class:"flex w-40 translate-x-[9rem] flex-col items-end"},je={class:"text-sm font-semibold uppercase leading-4"},Ve={key:0,class:"text-xs"},Fe={key:1,class:"text-xs"},Te={class:"mr-3 flex h-8 w-8 items-center justify-center rounded-md border bg-white"},Ne={class:"h-5 w-5"},Ee={class:"flex items-center justify-between"},Be={class:"text-sm"},Se={class:"uppercase"},Ue={class:"flex w-40 translate-x-[10.8rem] flex-col items-end"},ze={class:"text-sm font-semibold uppercase"},De={key:0,class:"text-xs"},Ie={key:1,class:"text-xs"},Pe={class:"grid grid-cols-2 gap-3"},Re={class:"label text-xs"},Ae={key:0,class:"text-xs uppercase"},qe={class:"label text-xs"},He={key:0,class:"text-xs uppercase"},Le=["value"],Me={class:"rounded-md bg-gray-100 p-4 dark:bg-slate-800"},Oe={class:"space-y-5 text-sm"},$e={class:"flex items-center justify-between"},Ge={class:"text-gray-400"},Je={class:"text-xs"},Ke={class:"uppercase"},Qe={class:"uppercase"},We={class:"flex items-center justify-between text-gray-400"},Xe={class:"text-sm"},Ye={class:"flex items-center justify-between text-gray-400"},Ze={class:"text-sm"},es={key:0,class:"text-xs uppercase"},ss={key:0,class:"rounded-md bg-gray-100 p-4 dark:bg-slate-800"},ts={class:"ml-6 mt-4 list-disc space-y-2"},as=O({layout:K}),ps=Object.assign(as,{__name:"Index",props:["accounts","request","exchange_details"],setup(p){const j=p,{formatCurrency:u,authUser:f,calculatePercent:I}=G(),r=A({from:"",to:"",amount:0}),y=k(()=>r.from?j.accounts.find(n=>n.currency_id==r.from):null),_=k(()=>r.to?j.accounts.find(n=>n.currency_id==r.to):null),v=k(()=>{if(y.value&&_.value&&r.amount){const n=y.value.rates.find(h=>h.virtual_currency_exchange_id==_.value.currency_id);return+r.amount*+n.rate}return 0}),P=k(()=>+v.value-I(+v.value,+f.value.plan_data.service_fee.value)),w=k(()=>{const n=j.accounts.find(o=>o.is_default===1);return n||null}),m=n=>j.accounts.find(x=>x.currency_id==n).rates.find(x=>x.virtual_currency_exchange_id===w.value.currency_id),R=()=>{r.post(route("user.exchange.store"),{onSuccess:()=>{r.reset()}})};return(n,o)=>{var x,T,N,E,B,S,U,z;const h=q("lazy");return c(),l("main",Q,[F(J,{title:"Exchange Currency"}),s("div",W,[s("div",null,[s("label",X,t(n.trans("From")),1),F(a(D),{onChange:o[0]||(o[0]=()=>a(r).reset("amount","to")),class:"multiselect-dark",searchable:!0,modelValue:a(r).from,"onUpdate:modelValue":o[1]||(o[1]=e=>a(r).from=e),mode:"single",label:"currency_name","value-prop":"currency_id",options:p.accounts,placeholder:"Currency"},{singlelabel:V(({value:e})=>{var i;return[s("div",Y,[s("div",Z,[C(s("img",ee,null,512),[[h,e.preview]])]),s("div",se,[s("p",te,[s("span",ae,t(e.currency_name),1),d(" "+t(n.trans("account")),1)]),s("p",ne,[s("span",ce,t(e.balance||"0.00")+" "+t(e.currency_name),1),w.value&&m(e.currency_id)?(c(),l("small",re,t(a(u)(((i=m(+e.currency_id))==null?void 0:i.rate)*+(e==null?void 0:e.balance),e.precision)),1)):(c(),l("small",le,t(a(u)(+(e==null?void 0:e.balance)||0)),1))])])])]}),option:V(({option:e})=>{var i;return[s("div",oe,[C(s("img",ie,null,512),[[h,e.preview]])]),s("div",de,[s("p",ue,[s("span",_e,t(e.currency_name),1),d(" "+t(n.trans("account")),1)]),s("p",me,[s("span",ye,t(e.balance||"0.00")+" "+t(e.currency_name),1),w.value&&m(e.currency_id)?(c(),l("small",he,t(a(u)(((i=m(+e.currency_id))==null?void 0:i.rate)*+(e==null?void 0:e.balance),e.precision)),1)):(c(),l("small",pe,t(a(u)(+(e==null?void 0:e.balance)||0)),1))])])]}),_:1},8,["modelValue","options"]),parseFloat(+a(r).amount)>parseFloat(+((x=y.value)==null?void 0:x.balance))?(c(),H($,{key:0,class:"text-xs font-semibold",message:"Not enough funds"})):b("",!0)]),s("div",null,[s("label",fe,t(n.trans("To")),1),F(a(D),{onChange:o[2]||(o[2]=()=>a(r).reset("amount")),class:"multiselect-dark",searchable:!0,modelValue:a(r).to,"onUpdate:modelValue":o[3]||(o[3]=e=>a(r).to=e),mode:"single",label:"currency_name","value-prop":"currency_id",options:p.accounts.filter(e=>e.currency_id!=a(r).from),placeholder:"Currency"},{singlelabel:V(({value:e})=>{var i;return[s("div",xe,[s("div",be,[C(s("img",ge,null,512),[[h,e.preview]])]),s("div",ve,[s("p",we,[s("span",ke,t(e.currency_name),1),d(" "+t(n.trans("account")),1)]),s("p",Ce,[s("span",je,t(e.balance||"0.00")+" "+t(e.currency_name),1),w.value&&m(e.currency_id)?(c(),l("small",Ve,t(a(u)(((i=m(+e.currency_id))==null?void 0:i.rate)*+(e==null?void 0:e.balance),e.precision)),1)):(c(),l("small",Fe,t(a(u)(+(e==null?void 0:e.balance)||0)),1))])])])]}),option:V(({option:e})=>{var i;return[s("div",Te,[C(s("img",Ne,null,512),[[h,e.preview]])]),s("div",Ee,[s("p",Be,[s("span",Se,t(e.currency_name),1),d(" "+t(n.trans("account")),1)]),s("p",Ue,[s("span",ze,t(e.balance||"0.00")+" "+t(e.currency_name),1),w.value&&m(e.currency_id)?(c(),l("small",De,t(a(u)(((i=m(+e.currency_id))==null?void 0:i.rate)*+(e==null?void 0:e.balance),e.precision)),1)):(c(),l("small",Ie,t(a(u)(+(e==null?void 0:e.balance)||0)),1))])])]}),_:1},8,["modelValue","options"])]),a(r).from&&a(r).to?(c(),l(g,{key:0},[s("div",Pe,[s("div",null,[s("label",Re,[d(t(n.trans("Transfer amount"))+" ",1),(T=y.value)!=null&&T.currency_name?(c(),l("span",Ae," ( "+t((N=y.value)==null?void 0:N.currency_name)+" ) ",1)):b("",!0)]),C(s("input",{"onUpdate:modelValue":o[4]||(o[4]=e=>a(r).amount=e),type:"number",class:"input",placeholder:"Transfer amount"},null,512),[[L,a(r).amount]])]),s("div",null,[s("label",qe,[d(t(n.trans("Amount enrolled"))+" ",1),(E=_.value)!=null&&E.currency_name?(c(),l("span",He," ( "+t((B=_.value)==null?void 0:B.currency_name)+" ) ",1)):b("",!0)]),s("input",{value:v.value,disabled:"",type:"number",class:"input",placeholder:"Amount enrolled"},null,8,Le)])]),s("div",Me,[s("div",Oe,[s("div",$e,[s("p",Ge,t(n.trans("Exchange rate")),1),s("p",Je,[d(" 1 "),s("span",Ke,t(y.value.currency_name),1),d(" = "+t((S=y.value.rates.find(e=>e.virtual_currency_exchange_id==_.value.currency_id))==null?void 0:S.rate)+" ",1),s("span",Qe,t(_.value.currency_name),1)])]),s("div",We,[s("p",null,t(n.trans("Service fee")),1),s("p",Xe,[a(f).plan_data.service_fee&&a(f).plan_data.service_fee.value>0?(c(),l(g,{key:0},[d(t(a(f).plan_data.service_fee.value)+" % ",1)],64)):(c(),l(g,{key:1},[d(t(n.trans("Not charged")),1)],64))])]),s("div",Ye,[s("p",null,t(n.trans("Total")),1),s("p",Ze,[a(f).plan_data.service_fee&&a(f).plan_data.service_fee.value>0?(c(),l(g,{key:0},[(U=_.value)!=null&&U.currency_name&&v.value>0?(c(),l("span",es,t((z=_.value)==null?void 0:z.currency_name),1)):b("",!0),d(" "+t(P.value),1)],64)):(c(),l(g,{key:1},[d(t(a(u)(+v.value)),1)],64))])])])]),p.exchange_details?(c(),l("div",ss,[s("p",null,t(p.exchange_details.title),1),s("ul",ts,[(c(!0),l(g,null,M(p.exchange_details.items,(e,i)=>(c(),l("li",{key:i},t(e.value),1))),128))])])):b("",!0),s("button",{onClick:R,type:"button",class:"btn w-full bg-secondary-950 py-3 text-secondary-50 hover:bg-secondary-800"},t(n.trans("Continue")),1)],64)):b("",!0)])])}}});export{ps as default};
