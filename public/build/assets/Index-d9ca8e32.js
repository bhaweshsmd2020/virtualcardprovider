import{T as W,z as w,k as q,x as H,o as c,c as l,a as k,b as e,n as D,u as n,h as i,t as s,p as E,F as v,e as p,l as j,v as L,r as M,f as O}from"./app-8b08b02b.js";import{s as $}from"./sharedComposable-7773727f.js";import{t as F}from"./toastComposable-d43a11ef.js";import{P as G}from"./PageHeader-f9559e85.js";import{_ as J}from"./UserLayout-90970d6e.js";import{s as K}from"./multiselect-44a34510.js";import"./dropdown-dfddaeee.js";import"./moment-a9aaa855.js";import"./Modal-68ba130b.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./ToastrContainer-e495c250.js";const Q={class:"container flex-grow p-4 sm:p-6"},X={class:"mx-auto max-w-lg space-y-6"},Y={class:"flex items-center gap-3"},Z={class:"mb-2"},ee={class:"label text-xs"},se={class:"multiselect-single-label"},te={class:"mr-3 flex h-8 w-8 items-center justify-center rounded-md border bg-white"},ae={class:"h-5 w-5"},ne={class:"flex items-center justify-between"},re={class:"text-sm"},ce={class:"uppercase"},le={class:"flex w-40 translate-x-[9rem] flex-col items-end"},oe={class:"text-sm font-semibold uppercase leading-4"},ie={key:0,class:"text-xs"},ue={key:1,class:"text-xs"},de={class:"mr-3 flex h-8 w-8 items-center justify-center rounded-md border bg-white"},_e={class:"h-5 w-5"},me={class:"flex items-center justify-between"},pe={class:"text-sm"},fe={class:"uppercase"},ye={class:"flex w-40 translate-x-[10.8rem] flex-col items-end"},be={class:"text-sm font-semibold uppercase"},he={key:0,class:"text-xs"},ve={key:1,class:"text-xs"},xe={class:"text-sm"},ge={class:"grid grid-cols-2 gap-3"},we={class:"label mb-1"},ke={key:0,class:"text-xs uppercase"},Ce={key:1,class:"text-xs uppercase"},je={class:"label mb-1"},Ae={key:0,class:"text-xs uppercase"},Ve={key:1,class:"text-xs uppercase"},Te=["value"],Ie={class:"rounded-md bg-gray-100 p-4 dark:bg-slate-800"},Ne={class:"space-y-5 text-sm"},Se={class:"flex items-center justify-between"},ze={class:"text-sm"},Be={key:0,class:"text-xs"},De={class:"uppercase"},Ee={class:"uppercase"},Fe={key:1,class:"text-xs"},Pe={class:"uppercase"},Ue={class:"uppercase"},Re={class:"flex items-center justify-between text-gray-400"},We={class:"text-sm"},qe={class:"flex items-center justify-between text-gray-400"},He={class:"text-sm"},Le={key:0,class:"text-xs uppercase"},Me={key:1,class:"text-xs uppercase"},Oe={key:0,class:"rounded-md bg-gray-100 p-4 dark:bg-slate-800"},$e={class:"ml-6 mt-4 list-disc space-y-2"},Ge=O({layout:J}),rs=Object.assign(Ge,{__name:"Index",props:["accounts","transfer_details"],setup(x){const C=x,{formatCurrency:y,authUser:m,calculatePercent:P}=$(),t=W({transfer_to:"balance",wallet_id:"",amount:0}),o=w(()=>t.wallet_id?C.accounts.find(r=>r.wallet_id===t.wallet_id):[]),d=w(()=>{const r=C.accounts.find(u=>u.is_default===1);return r||null}),_=r=>{const u=C.accounts.find(b=>b.currency_id==r);if(t.transfer_to=="balance")return u.rates.find(h=>h.virtual_currency_exchange_id===d.value.currency_id);if(t.transfer_to=="wallet"&&o.value)return d.value.rates.find(h=>h.virtual_currency_exchange_id===u.currency_id)},g=w(()=>{var r;return t.wallet_id?o.value.currency_id==d.value.currency_id?+t.amount:_(o.value.currency_id)?+((r=_(o.value.currency_id))==null?void 0:r.rate)*t.amount:0:0}),U=w(()=>+g.value-P(+g.value,+m.value.plan_data.service_fee.value)),R=()=>{if(t.transfer_to==="wallet"&&t.amount>m.value.balance){F.danger("Insufficient balance");return}if(t.transfer_to==="balance"&&t.amount>o.value.balance){F.danger("Insufficient wallet balance");return}t.transform(r=>({...r,requestedAmount:r.amount,amount:+g.value,default_currency:d.value.currency_name,transfer_currency:o.value.currency_name})).post(route("user.transfer.store"),{onSuccess:()=>{t.reset()}})};return(r,u)=>{var A,V,T,I,N,S,z,B;const b=q("Icon"),h=H("lazy");return c(),l("main",Q,[k(G,{title:"Transfer"}),e("div",X,[e("div",Y,[e("button",{class:D(["btn flex-1",n(t).transfer_to==="balance"?"btn-primary":"bg-gray-200 dark:bg-secondary-700"]),onClick:u[0]||(u[0]=()=>{n(t).reset(),n(t).transfer_to="balance"})},[i(s(r.trans("Wallet"))+" ",1),k(b,{class:"text-lg",icon:"heroicons:arrow-long-right"}),i(" "+s(r.trans("Account")),1)],2),e("button",{class:D(["btn flex-1",n(t).transfer_to==="wallet"?"btn-primary":"bg-gray-200 dark:bg-secondary-700"]),onClick:u[1]||(u[1]=()=>{n(t).reset(),n(t).transfer_to="wallet"})},[i(s(r.trans("Account"))+" ",1),k(b,{class:"text-lg",icon:"heroicons:arrow-long-right"}),i(" "+s(r.trans("Wallet")),1)],2)]),e("div",Z,[e("label",ee,s(r.trans("Select Account")),1),k(n(K),{onChange:u[2]||(u[2]=()=>{n(t).amount=0}),class:"multiselect-dark",searchable:!0,modelValue:n(t).wallet_id,"onUpdate:modelValue":u[3]||(u[3]=a=>n(t).wallet_id=a),mode:"single",label:"currency_name","value-prop":"wallet_id",options:x.accounts,placeholder:"Account"},{singlelabel:E(({value:a})=>{var f;return[e("div",se,[e("div",te,[j(e("img",ae,null,512),[[h,a.preview]])]),e("div",ne,[e("p",re,[e("span",ce,s(a.currency_name),1),i(" "+s(r.trans("account")),1)]),e("p",le,[e("span",oe,s(a.balance||"0.00")+" "+s(a.currency_name),1),d.value&&_(a.currency_id)?(c(),l("small",ie,s(n(y)(((f=_(+a.currency_id))==null?void 0:f.rate)*+(a==null?void 0:a.balance),a.precision)),1)):(c(),l("small",ue,s(n(y)(+(a==null?void 0:a.balance)||0)),1))])])])]}),option:E(({option:a})=>{var f;return[e("div",de,[j(e("img",_e,null,512),[[h,a.preview]])]),e("div",me,[e("p",pe,[e("span",fe,s(a.currency_name),1),i(" "+s(r.trans("account")),1)]),e("p",ye,[e("span",be,s(a.balance||"0.00")+" "+s(a.currency_name),1),d.value&&_(a.currency_id)?(c(),l("small",he,s(n(y)(((f=_(+a.currency_id))==null?void 0:f.rate)*+(a==null?void 0:a.balance),a.precision)),1)):(c(),l("small",ve,s(n(y)(+(a==null?void 0:a.balance)||0)),1))])])]}),_:1},8,["modelValue","options"])]),e("p",xe,s(r.trans("Current Balance"))+" "+s(n(y)(n(m).balance)),1),n(t).wallet_id&&n(t).transfer_to?(c(),l(v,{key:0},[e("div",ge,[e("div",null,[e("label",we,[i(s(r.trans("Transfer amount"))+" ",1),(A=o.value)!=null&&A.currency_name&&n(t).transfer_to==="balance"?(c(),l("span",ke," ( "+s((V=o.value)==null?void 0:V.currency_name)+" ) ",1)):p("",!0),n(t).transfer_to==="wallet"?(c(),l("span",Ce," ( "+s((T=d.value)==null?void 0:T.currency_name)+" ) ",1)):p("",!0)]),j(e("input",{"onUpdate:modelValue":u[4]||(u[4]=a=>n(t).amount=a),type:"number",class:"input",placeholder:"Transfer amount"},null,512),[[L,n(t).amount]])]),e("div",null,[e("label",je,[i(s(r.trans("Amount enrolled"))+" ",1),n(t).transfer_to==="balance"?(c(),l("span",Ae," ( "+s((I=d.value)==null?void 0:I.currency_name)+" ) ",1)):p("",!0),(N=o.value)!=null&&N.currency_name&&n(t).transfer_to==="wallet"?(c(),l("span",Ve," ( "+s((S=o.value)==null?void 0:S.currency_name)+" ) ",1)):p("",!0)]),e("input",{disabled:"",readonly:"",value:g.value,type:"number",class:"input",placeholder:"Amount enrolled"},null,8,Te)])]),e("div",Ie,[e("div",Ne,[e("div",Se,[e("p",ze,s(r.trans("Exchange rate"))+" :",1),n(t).transfer_to==="balance"?(c(),l("p",Be,[i(" 1 "),e("span",De,s(o.value.currency_name),1),i(" = "+s(d.value&&_(o.value.currency_id)?(z=_(o.value.currency_id))==null?void 0:z.rate:1)+" ",1),e("span",Ee,s(d.value.currency_name),1)])):(c(),l("p",Fe,[i(" 1 "),e("span",Pe,s(d.value.currency_name),1),i(" = "+s(d.value&&_(o.value.currency_id)?(B=_(o.value.currency_id))==null?void 0:B.rate:1)+" ",1),e("span",Ue,s(o.value.currency_name),1)]))]),e("div",Re,[e("p",null,s(r.trans("Service fee")),1),e("p",We,[n(m).plan_data.service_fee&&n(m).plan_data.service_fee.value>0?(c(),l(v,{key:0},[i(s(n(m).plan_data.service_fee.value)+" % ",1)],64)):(c(),l(v,{key:1},[i(s(r.trans("Not charged")),1)],64))])]),e("div",qe,[e("p",null,s(r.trans("Total")),1),e("p",He,[n(m).plan_data.service_fee&&n(m).plan_data.service_fee.value>0?(c(),l(v,{key:0},[i(s(U.value)+" ",1),n(t).transfer_to==="balance"?(c(),l("span",Le,s(d.value.currency_name),1)):p("",!0),n(t).transfer_to==="wallet"?(c(),l("span",Me,s(o.value.currency_name),1)):p("",!0)],64)):(c(),l(v,{key:1},[i(s(n(y)(+g.value)),1)],64))])])])]),x.transfer_details?(c(),l("div",Oe,[e("p",null,s(x.transfer_details.title),1),e("ul",$e,[(c(!0),l(v,null,M(x.transfer_details.items,(a,f)=>(c(),l("li",{key:f},s(a.value),1))),128))])])):p("",!0),e("button",{onClick:R,type:"button",class:"btn w-full bg-secondary-950 py-3 text-secondary-50 hover:bg-secondary-800"},s(r.trans("Continue")),1)],64)):p("",!0)])])}}});export{rs as default};
