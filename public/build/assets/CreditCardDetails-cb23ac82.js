import{T as O,j as u,o as i,c as n,b as t,a as J,t as s,h as U,u as m,n as Q,e as v,w as z,l as R,v as W,F as X,K as b,a3 as Z,a4 as $}from"./app-8b08b02b.js";import{s as tt,m as f}from"./sharedComposable-7773727f.js";import{h as et}from"./moment-a9aaa855.js";import{C as st}from"./CreditCard-6ead730a.js";import{t as x}from"./toastComposable-d43a11ef.js";import{S as E}from"./sweetalert2.esm.all-df3a4912.js";import{_ as at}from"./_plugin-vue_export-helper-c27b6911.js";const c=a=>(Z("data-v-046c79ed"),a=a(),$(),a),dt={class:"card-body card space-y-12"},ot={class:"grid grid-cols-1 gap-10 lg:grid-cols-8 2xl:grid-cols-12"},rt={class:"lg:col-span-4 2xl:col-span-3"},it={class:"mb-10 flex items-center justify-between"},nt={class:"text-sm font-semibold text-slate-500"},ct={class:"text-3xl font-semibold"},lt={class:"text-sm uppercase"},ut={key:0,class:"text-xl ml-2"},mt=c(()=>t("i",{class:"bx bx-loader bx-spin"},null,-1)),_t=[mt],ht={class:"mb-10 flex items-start justify-between"},pt={class:"text-sm font-semibold text-slate-500"},Ct={class:"text-3xl font-semibold"},vt={class:"text-sm uppercase"},bt={class:"flex items-center justify-between"},ft={class:"text-sm font-semibold text-slate-500"},xt={class:"text-1xl font-semibold"},yt={class:"lg:col-span-8 2xl:col-span-5"},gt={class:"grid grid-cols-3"},kt={class:"text-sm font-semibold"},wt={class:"text-xs text-slate-500"},St={class:"text-sm font-semibold"},Bt={class:"my-7 grid grid-cols-3"},Nt={class:"text-sm font-semibold"},Dt={class:"text-xs uppercase text-slate-500"},At={class:"text-sm font-semibold"},Tt={class:"text-xs text-slate-500"},Mt={key:0},jt={class:"grid grid-cols-3"},Vt={class:"text-sm font-semibold"},Yt={class:"text-xs text-slate-400"},It={class:"text-sm font-semibold"},Ot={class:"text-xs text-slate-400"},Ut={key:0},zt={class:"mt-7 grid grid-cols-3"},Et={class:"text-sm font-semibold"},Ft={class:"text-xs text-slate-400"},Lt={class:"text-sm font-semibold"},Pt=c(()=>t("p",{class:"text-xs text-slate-400"}," 30096 ",-1)),qt={class:"modal-content"},Ht=c(()=>t("h2",{class:"modal-title"},"Update Card",-1)),Kt={class:"form-group"},Gt=c(()=>t("label",{for:"name_on_card"},"Name on Card:",-1)),Jt=c(()=>t("button",{type:"submit",class:"btn btn-primary"},"Update",-1)),Qt={__name:"CreditCardDetails",props:{creditCard:Object,canEdit:{type:Boolean,default:!1},revealBtn:{type:Boolean,default:!1},stripe_pk_key:String,cardDetails:Object,otherCity:String,otherState:String},setup(a){const d=a,{formatCurrency:F,authUser:r}=tt();O({amount:d.creditCard.spending_limits});const y=O({status:d.creditCard.status}),_=u(d.creditCard.available_limits),h=u(!1),p=u(!1),l=u({card_id:d.creditCard.id,name_on_card:""}),L=()=>{l.value.name_on_card=d.creditCard.name_on_card,p.value=!0},C=()=>{p.value=!1},P=async()=>{try{await b.post(route("admin.credit-card.update"),l.value),C(),x.success("Card updated successfully!")}catch(e){x.error("There was an error updating the card."),console.error(e)}},q=()=>{const e={method:"patch",data:{status:y.status},options:{confirm_text:"Are you sure want to do this action ?",message:"Change card status",accept_btn_text:"Yes, Confirm",reject_btn_text:"No, Cancel"}};if(r.value.role==="user"){const o=d.creditCard.status;f.init(route("user.credit-card.update-status",{id:d.creditCard.id,status:o}),e)}if(r.value.role==="admin"){const o=d.creditCard.status;f.init(route("admin.credit-card.update-status",{id:d.creditCard.id,status:o}),e)}},H=()=>{const e={method:"patch",data:{status:y.status},options:{confirm_text:"Are you sure want to do this action ?",message:"Change card status",accept_btn_text:"Yes, Confirm",reject_btn_text:"No, Cancel"}};r.value.role==="admin"&&f.init(route("admin.credit-card.terminate",{id:d.creditCard.id}),e)},K=async()=>{h.value=!0;try{if(r.value.role==="user"){const e=await b.get(route("user.credit-card.balance",{id:d.creditCard.id}));_.value=e.data.updated_balance}else{const e=await b.get(route("admin.credit-card.balance",{id:d.creditCard.id}));_.value=e.data.updated_balance}E.fire({icon:"success",title:"<h2 style='font-size: 20px;'>Balance updated successfully</h2>",confirmButtonText:"Okay",allowOutsideClick:!1,customClass:{popup:"custom-swal-popup"},didOpen:e=>{const o=document.createElement("button");o.innerHTML="&times;",o.classList.add("swal-close-btn"),o.onclick=()=>E.close(),e.appendChild(o)}})}catch(e){x.error("There was an error updating the balance."),console.error(e)}finally{h.value=!1}};return(e,o)=>{var g,k,w,S,B,N,D,A,T,M,j,V,Y,I;return i(),n(X,null,[t("div",dt,[t("div",ot,[J(st,{stripe_pk_key:a.stripe_pk_key,revealBtn:a.revealBtn,"credit-card":a.creditCard,"card-details":a.cardDetails,"other-state":a.otherState,"other-city":a.otherCity},null,8,["stripe_pk_key","revealBtn","credit-card","card-details","other-state","other-city"]),t("div",rt,[t("div",it,[t("div",null,[t("p",nt,s(e.trans("Available Balance")),1),t("p",ct,[U(s(_.value)+" ",1),t("span",lt,s(a.creditCard.currency),1),h.value?(i(),n("span",ut,_t)):(i(),n("i",{key:1,class:"bx bx-refresh text-xl ml-2 cursor-pointer",onClick:K}))])])]),t("div",ht,[t("div",null,[t("p",pt,s(e.trans("Total Balance")),1),t("p",Ct,[U(s(m(F)(+d.cardDetails.spending_restrictions.amount||0).slice(1))+" ",1),t("span",vt,s(a.creditCard.currency),1)])])]),t("div",bt,[t("div",null,[t("p",ft,s(e.trans("Spending Interval")),1),t("p",xt,s(d.cardDetails.spending_restrictions.interval),1)])])]),t("div",yt,[t("div",gt,[t("div",null,[t("p",kt,s(e.trans("Card Type")),1),t("p",wt,s(e.trans("Virtual")),1)]),t("div",null,[t("p",St,s(e.trans("Status")),1),t("p",{class:Q(["badge capitalize",a.creditCard.status==="active"?"badge-success":"badge-danger"])},s(a.creditCard.status),3)]),t("button",{onClick:q,type:"button",class:"btn btn-primary"},s(a.creditCard.status==="active"?e.trans("Deactivate"):e.trans("Activate"))+" "+s(e.trans("Card")),1)]),t("div",Bt,[t("div",null,[t("p",Nt,s(e.trans("Card Currency")),1),t("p",Dt,s(a.creditCard.currency),1)]),t("div",null,[t("p",At,s(e.trans("Card Created")),1),t("p",Tt,s(m(et)(a.creditCard.created_at).format("MMM DD, YYYY")),1)]),m(r).role=="admin"?(i(),n("div",Mt,[t("button",{class:"btn btn-warning",onClick:L},[t("span",null,s(e.trans("Update Card")),1)])])):v("",!0)]),t("div",jt,[t("div",null,[t("p",Vt,s(e.trans("Country")),1),t("p",Yt,s((k=(g=a.creditCard.user)==null?void 0:g.country)==null?void 0:k.name),1)]),t("div",null,[t("p",It,s(e.trans("State")),1),t("p",Ot,s(((w=a.creditCard.user)==null?void 0:w.state_id)===null?"N/A":((S=a.creditCard.user)==null?void 0:S.state_id)===1e3?((B=a.otherState)==null?void 0:B.name)||"N/A":((D=(N=a.creditCard.user)==null?void 0:N.state)==null?void 0:D.name)||"N/A"),1)]),m(r).role=="admin"?(i(),n("div",Ut,[t("button",{onClick:H,type:"button",class:"btn btn-danger"},s(e.trans("Terminate Card")),1)])):v("",!0)]),t("div",zt,[t("div",null,[t("p",Et,s(e.trans("City"))+" / "+s(e.trans("Postal Code")),1),t("p",Ft,s(((A=a.creditCard.user)==null?void 0:A.city_id)===null?"N/A":((T=a.creditCard.user)==null?void 0:T.city_id)===1e3?((M=a.otherCity)==null?void 0:M.name)||"N/A":((V=(j=a.creditCard.user)==null?void 0:j.city)==null?void 0:V.name)||"N/A")+" - "+s((I=(Y=a.creditCard.user)==null?void 0:Y.city)==null?void 0:I.postal_code),1)]),t("div",null,[t("p",Lt,s(e.trans("Card Postal Code")),1),Pt])])])])]),p.value?(i(),n("div",{key:0,class:"modal-overlay",onClick:z(C,["self"])},[t("div",qt,[t("div",{class:"modal-header"},[Ht,t("button",{onClick:C,class:"close-btn"},"Ã—")]),t("form",{onSubmit:z(P,["prevent"])},[t("div",Kt,[Gt,R(t("input",{"onUpdate:modelValue":o[0]||(o[0]=G=>l.value.name_on_card=G),id:"name_on_card",type:"text",placeholder:"Name on Card",required:""},null,512),[[W,l.value.name_on_card]])]),Jt],32)])])):v("",!0)],64)}}},se=at(Qt,[["__scopeId","data-v-046c79ed"]]);export{se as C};
