import{j as C,z as j,x as H,o as l,c as o,a as G,b as e,t as s,p as M,u as i,h,e as b,l as v,v as q,F as x,r as O,f as L,n as W,P as R,w as J,O as K}from"./app-55c25e51.js";import{P as Q}from"./PageHeader-8abf30c3.js";import{_ as X}from"./UserLayout-5a6919f2.js";import{t as $}from"./toastComposable-bc1f97e9.js";import{s as Z}from"./sharedComposable-713147fd.js";import{s as ee}from"./multiselect-5f58dd69.js";import"./dropdown-8ee40221.js";import"./moment-a9aaa855.js";import"./Modal-522ea419.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./ToastrContainer-869d906f.js";const te={class:"container flex-grow p-4 sm:p-6"},se={class:"mx-auto max-w-lg"},ae={class:"mb-2"},ne={class:"label text-xs"},le={class:"multiselect-single-label"},oe={class:"mr-3 flex h-8 w-8 items-center justify-center rounded-md border bg-white"},re={class:"h-5 w-5"},ce={class:"flex items-center justify-between"},ie={class:"text-sm"},ue={class:"uppercase"},de={class:"flex w-40 translate-x-[9rem] flex-col items-end"},me={class:"text-sm font-semibold uppercase leading-4"},_e={key:0,class:"text-xs"},pe={key:1,class:"text-xs"},he={class:"mr-3 flex h-8 w-8 items-center justify-center rounded-md border bg-white"},ve={class:"h-5 w-5"},ye={class:"flex items-center justify-between"},fe={class:"text-sm"},be={class:"uppercase"},xe={class:"flex w-40 translate-x-[10.8rem] flex-col items-end"},ge={class:"text-sm font-semibold uppercase"},we={key:0,class:"text-xs"},ke={key:1,class:"text-xs"},Ce={key:0,class:"my-2 flex items-center justify-end gap-2 dark:text-gray-300"},je={class:"text-sm"},Ve={class:"text-xs"},Pe={class:"uppercase"},Ae={class:"uppercase"},Te={class:"mx-auto max-w-lg space-y-5"},Ne={class:"text-xl font-semibold"},Se={class:"label mb-1"},qe={key:0,class:"text-xs uppercase"},Fe={class:"label mb-1"},Ue={key:0,class:"text-xs uppercase"},ze=["value"],Ee={class:"mt-2 font-semibold"},Be={class:"flex items-center justify-between"},De={class:"label dark:text-gray-200"},Ge={class:"text-sm dark:text-gray-200"},Me={class:"my-4 grid grid-cols-4"},Oe=["onClick"],Re=e("i",{class:"bx bx-check absolute right-[-10px] top-[-10px] rounded-full bg-primary-600 p-0.5 text-white"},null,-1),$e=[Re],Ie={class:"h-8 w-full rounded object-contain p-1"},Ye=["id"],He=["onSubmit"],Le={class:"flex items-center justify-between"},We={class:"label dark:text-gray-200"},Je={class:"text-sm dark:text-gray-200"},Ke={class:"label mt-4 font-semibold dark:text-gray-200"},Qe={class:"mt-1 text-sm dark:text-gray-200"},Xe={key:1,class:"mt-4"},Ze={class:"label mb-1"},et={class:"mt-2"},tt={class:"label mb-1"},st={class:"mt-3"},at={class:"label mb-1"},nt=["disabled"],lt=L({layout:X}),yt=Object.assign(lt,{__name:"Wallet",props:["gateways","accounts"],setup(V){var F;const r=C({currency:"",type:"balance",wallet_id:"",amount:50}),g=V,{formatCurrency:d,authUser:T}=Z(),w=C(((F=g.gateways[0])==null?void 0:F.id)||0),N=C(null),S=C(!1),P=C({image:null,comment:""}),m=j(()=>g.gateways.find(a=>a.id===w.value)),_=j(()=>r.value.wallet_id?g.accounts.find(a=>a.wallet_id===r.value.wallet_id):[]),c=j(()=>{const a=g.accounts.find(n=>n.is_default===1);return a||null}),I=j(()=>{var a;if(c.value)return(a=c.value.rates.find(n=>n.virtual_currency_exchange_id==_.value.currency_id))==null?void 0:a.rate}),Y=a=>{if(m.value.min_amount>k.value){$.danger("The minimum transaction amount is "+d(m.value.min_amount));return}if(m.value.max_amount!=-1&&m.value.max_amount<k.value){$.danger("The maximum transaction amount is "+d(m.value.max_amount));return}S.value=!0,K.post(route("user.top-up.store"),{gateway_id:a,total:k.value,requested_amount:r.value.amount,manualPayment:m.value.is_auto==0?P.value:null,wallet_id:r.value.wallet_id,rate:I.value||1,phone:m.value.phone_required==1?N.value:null},{onFinish:()=>{S.value=!1}})},p=a=>g.accounts.find(y=>y.currency_id==a).rates.find(y=>y.virtual_currency_exchange_id===c.value.currency_id),k=j(()=>{var a;return r.value.wallet_id?c.value&&p(_.value.currency_id)?(+r.value.amount*+((a=p(_.value.currency_id))==null?void 0:a.rate)).toFixed(2):+r.value.amount:0});return(a,n)=>{var y,U,z,E,B,D;const A=H("lazy");return l(),o("main",te,[G(Q,{title:"Topup"}),e("div",se,[e("div",ae,[e("label",ne,s(a.trans("Select Account")),1),G(i(ee),{onChange:n[0]||(n[0]=()=>{r.value.amount=0}),class:"multiselect-dark",searchable:!0,modelValue:r.value.wallet_id,"onUpdate:modelValue":n[1]||(n[1]=t=>r.value.wallet_id=t),mode:"single",label:"currency_name","value-prop":"wallet_id",options:V.accounts,placeholder:"Account"},{singlelabel:M(({value:t})=>{var u;return[e("div",le,[e("div",oe,[v(e("img",re,null,512),[[A,t.preview]])]),e("div",ce,[e("p",ie,[e("span",ue,s(t.currency_name),1),h(" "+s(a.trans("account")),1)]),e("p",de,[e("span",me,s(t.balance||"0.00")+" "+s(t.currency_name),1),c.value&&p(t.currency_id)?(l(),o("small",_e,s(i(d)(((u=p(+t.currency_id))==null?void 0:u.rate)*+(t==null?void 0:t.balance),t.precision)),1)):(l(),o("small",pe,s(i(d)(+(t==null?void 0:t.balance)||0)),1))])])])]}),option:M(({option:t})=>{var u;return[e("div",he,[v(e("img",ve,null,512),[[A,t.preview]])]),e("div",ye,[e("p",fe,[e("span",be,s(t.currency_name),1),h(" "+s(a.trans("account")),1)]),e("p",xe,[e("span",ge,s(t.balance||"0.00")+" "+s(t.currency_name),1),c.value&&p(t.currency_id)?(l(),o("small",we,s(i(d)(((u=p(+t.currency_id))==null?void 0:u.rate)*+(t==null?void 0:t.balance),t.precision)),1)):(l(),o("small",ke,s(i(d)(+(t==null?void 0:t.balance)||0)),1))])])]}),_:1},8,["modelValue","options"])]),r.value.wallet_id?(l(),o("div",Ce,[e("p",je,s(a.trans("Exchange rate"))+" :",1),e("p",Ve,[h(" 1 "),e("span",Pe,s((y=_.value)==null?void 0:y.currency_name),1),h(" = "+s(c.value&&p(_.value.currency_id)?(U=p(_.value.currency_id))==null?void 0:U.rate:1)+" ",1),e("span",Ae,s(c.value.currency_name),1)])])):b("",!0)]),e("div",Te,[e("p",Ne,s(a.trans("Method of payment")),1),e("div",null,[e("label",Se,[h(s(a.trans("Amount"))+" ",1),(z=_.value)!=null&&z.currency_name?(l(),o("span",qe," ( "+s((E=_.value)==null?void 0:E.currency_name)+" ) ",1)):b("",!0)]),v(e("input",{class:"input",step:"5",type:"number","onUpdate:modelValue":n[2]||(n[2]=t=>r.value.amount=t),placeholder:"Enter Credit amount"},null,512),[[q,r.value.amount,void 0,{number:!0}]])]),e("div",null,[e("label",Fe,[h(s(a.trans("Amount enrolled"))+" ",1),(B=c.value)!=null&&B.currency_name?(l(),o("span",Ue," ( "+s((D=c.value)==null?void 0:D.currency_name)+" ) ",1)):b("",!0)]),e("input",{disabled:"",readonly:"",value:k.value,type:"number",class:"input",placeholder:"Amount enrolled"},null,8,ze)]),e("p",Ee,s(a.trans("Total:"))+" "+s(i(d)(k.value)),1),e("div",Be,[e("p",De,s(a.trans("Transaction Fee:")),1),e("p",Ge,[i(T).plan_data.transaction_fee&&i(T).plan_data.transaction_fee.value>0?(l(),o(x,{key:0},[h(s(i(T).plan_data.transaction_fee.value)+" % ",1)],64)):(l(),o(x,{key:1},[h(s(a.trans("Not charged")),1)],64))])]),e("div",Me,[(l(!0),o(x,null,O(V.gateways,t=>(l(),o("button",{key:t.id,class:W(["relative rounded dark:border-gray-600",{border:w.value==t.id}]),onClick:u=>w.value=t.id},[v(e("div",null,$e,512),[[R,w.value==t.id]]),v(e("img",Ie,null,512),[[A,t.logo]])],10,Oe))),128))]),(l(!0),o(x,null,O(V.gateways,t=>{var u;return v((l(),o("div",{key:t.id,id:"gateway-form"+t.id},[e("form",{method:"post",onSubmit:J(f=>Y(t.id),["prevent"]),enctype:"multipart/form-data"},[e("div",Le,[e("p",We,s(a.trans("Gateway Charge: ")),1),e("p",Je,s(i(d)(t.charge)),1)]),t.comment!=null?(l(),o(x,{key:0},[e("label",Ke,s(a.trans("Payment Instruction: ")),1),e("p",Qe,s(t.comment),1)],64)):b("",!0),t.phone_required==1?(l(),o("div",Xe,[e("label",Ze,s(a.trans("Your phone number")),1),v(e("input",{type:"tel",name:"phone",placeholder:"Your phone number",class:"input","onUpdate:modelValue":n[3]||(n[3]=f=>N.value=f)},null,512),[[q,N.value]])])):b("",!0),t.is_auto==0&&((u=m.value)==null?void 0:u.is_crypto)!=1?(l(),o(x,{key:2},[e("div",et,[e("label",tt,s(a.trans("Submit your payment proof")),1),e("input",{onInput:n[4]||(n[4]=f=>{P.value.image=f.target.files[0]}),type:"file",name:"image",class:"input",required:"",accept:"image/*"},null,32)]),e("div",st,[e("label",at,s(a.trans("Comment")),1),v(e("textarea",{"onUpdate:modelValue":n[5]||(n[5]=f=>P.value.comment=f),class:"textarea",required:"",name:"comment",placeholder:"comment",maxlength:"500"},null,512),[[q,P.value.comment]])])],64)):b("",!0),e("button",{disabled:S.value,type:"submit",class:"btn btn-primary mt-4 w-full py-2 text-lg"},s(a.trans("Pay Now")),9,nt)],40,He)],8,Ye)),[[R,w.value===t.id]])}),128))])])}}});export{yt as default};
